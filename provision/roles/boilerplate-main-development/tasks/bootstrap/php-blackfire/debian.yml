---

- name: Remove xdebug
  file:
    path: "{{ item }}"
    state: absent
  with_items:
   # PHP 5.x
   - "/etc/php5/mods-available/xdebug.ini"
   - "/etc/php5/cli/conf.d/20-xdebug.ini"
   - "/etc/php5/cli/conf.d/xdebug.ini"
   - "/etc/php5/fpm/conf.d/20-xdebug.ini"
   - "/etc/php5/fpm/conf.d/xdebug.ini"
   # PHP 7.x
   - "/etc/php/7.0/mods-available/xdebug.ini"
   - "/etc/php/7.0/cli/conf.d/20-xdebug.ini"
   - "/etc/php/7.0/fpm/conf.d/20-xdebug.ini"

- name: Add blackfire.io key
  apt_key:
    url:   https://packagecloud.io/gpg.key
    state: present

- name: Add blackfire.io repository
  apt_repository:
    repo:  'deb http://packages.blackfire.io/debian any main'
    state: present
    update_cache: yes

- name: Install blackfire-php
  apt:
    name:  '{{ item }}'
    state: present
  with_items:
    - blackfire-php
